### New MR
POST http://localhost:5000/gitlab-webhook
Content-Type: application/json

{"object_kind":"merge_request","event_type":"merge_request","user":{"name":"Will Pimblett","username":"will.pimblett","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4788069/avatar.png","email":"will@wegift.io"},"project":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"object_attributes":{"assignee_id":null,"author_id":4788069,"created_at":"2020-06-11 16:17:37 UTC","description":"","head_pipeline_id":null,"id":61285744,"iid":2,"last_edited_at":null,"last_edited_by_id":null,"merge_commit_sha":null,"merge_error":null,"merge_params":{"force_remove_source_branch":"1"},"merge_status":"unchecked","merge_user_id":null,"merge_when_pipeline_succeeds":false,"milestone_id":null,"source_branch":"ch3984/test2","source_project_id":19326693,"state_id":1,"target_branch":"master","target_project_id":19326693,"time_estimate":0,"title":"Update test.txt","updated_at":"2020-06-11 16:17:37 UTC","updated_by_id":null,"url":"https://gitlab.com/wegift/test-repo/-/merge_requests/2","source":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"target":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"last_commit":{"id":"23c082231d9e996655d415b592a643abd6e5ce84","message":"Update test.txt","title":"Update test.txt","timestamp":"2020-06-11T16:17:32+00:00","url":"https://gitlab.com/wegift/test-repo/-/commit/23c082231d9e996655d415b592a643abd6e5ce84","author":{"name":"Will Pimblett","email":"will@wegift.io"}},"work_in_progress":false,"total_time_spent":0,"human_total_time_spent":null,"human_time_estimate":null,"assignee_ids":[],"state":"opened","action":"open"},"labels":[],"changes":{"author_id":{"previous":null,"current":4788069},"created_at":{"previous":null,"current":"2020-06-11 16:17:37 UTC"},"description":{"previous":null,"current":""},"id":{"previous":null,"current":61285744},"iid":{"previous":null,"current":2},"merge_params":{"previous":{},"current":{"force_remove_source_branch":"1"}},"source_branch":{"previous":null,"current":"ch3984/test2"},"source_project_id":{"previous":null,"current":19326693},"target_branch":{"previous":null,"current":"master"},"target_project_id":{"previous":null,"current":19326693},"title":{"previous":null,"current":"Update test.txt"},"updated_at":{"previous":null,"current":"2020-06-11 16:17:37 UTC"},"total_time_spent":{"previous":null,"current":0}},"repository":{"name":"Test Repo","url":"git@gitlab.com:wegift/test-repo.git","description":"","homepage":"https://gitlab.com/wegift/test-repo"}}

### MR Approve
POST http://localhost:5000/gitlab-webhook
Content-Type: application/json

{"object_kind":"merge_request","event_type":"merge_request","user":{"name":"Clubhouse Bot","username":"will.pimblett","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/5470008/avatar.png","email":"will+clubhouse@wegift.io"},"project":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"object_attributes":{"assignee_id":null,"author_id":4788069,"created_at":"2020-06-11 16:17:37 UTC","description":"","head_pipeline_id":null,"id":61285744,"iid":2,"last_edited_at":null,"last_edited_by_id":null,"merge_commit_sha":null,"merge_error":null,"merge_params":{"force_remove_source_branch":"1"},"merge_status":"can_be_merged","merge_user_id":null,"merge_when_pipeline_succeeds":false,"milestone_id":null,"source_branch":"ch3984/test2","source_project_id":19326693,"state_id":1,"target_branch":"master","target_project_id":19326693,"time_estimate":0,"title":"Update test.txt","updated_at":"2020-06-11 16:18:39 UTC","updated_by_id":null,"url":"https://gitlab.com/wegift/test-repo/-/merge_requests/2","source":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"target":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"last_commit":{"id":"23c082231d9e996655d415b592a643abd6e5ce84","message":"Update test.txt","title":"Update test.txt","timestamp":"2020-06-11T16:17:32+00:00","url":"https://gitlab.com/wegift/test-repo/-/commit/23c082231d9e996655d415b592a643abd6e5ce84","author":{"name":"Will Pimblett","email":"will@wegift.io"}},"work_in_progress":false,"total_time_spent":0,"human_total_time_spent":null,"human_time_estimate":null,"assignee_ids":[],"state":"opened","action":"approved"},"labels":[],"changes":{"updated_at":{"previous":"2020-06-11 16:17:37 UTC","current":"2020-06-11 16:18:39 UTC"},"total_time_spent":{"previous":null,"current":0}},"repository":{"name":"Test Repo","url":"git@gitlab.com:wegift/test-repo.git","description":"","homepage":"https://gitlab.com/wegift/test-repo"}}

### MR Approval
POST http://localhost:5000/gitlab-webhook
Content-Type: application/json

{"object_kind":"merge_request","event_type":"merge_request","user":{"name":"Atta Rehman","username":"ar-wegift","avatar_url":"https://secure.gravatar.com/avatar/cdf5d423016002b15c16350181dd2613?s=80\u0026d=identicon","email":"atta@wegift.io"},"project":{"id":14982635,"name":"scion","description":":dancer: Get gifty :dancers: :beers:","web_url":"https://gitlab.com/wegift/scion","avatar_url":"https://gitlab.com/uploads/-/system/project/avatar/14982635/scion.png","git_ssh_url":"git@gitlab.com:wegift/scion.git","git_http_url":"https://gitlab.com/wegift/scion.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/scion","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/scion","url":"git@gitlab.com:wegift/scion.git","ssh_url":"git@gitlab.com:wegift/scion.git","http_url":"https://gitlab.com/wegift/scion.git"},"object_attributes":{"assignee_id":38913,"author_id":38913,"created_at":"2020-06-15 13:40:51 UTC","description":"See: https://app.clubhouse.io/wegift/story/4023/run-long-unit-tests-in-background\r\n\r\nIntegration tests will run in master and schedule. (if you think it's useful we can run them in tags and rc branches too).\r\n\r\nRan tests in local and it took \u003c5 minutes but it took more time in CI gitlab runners (see https://gitlab.com/wegift/scion/-/jobs/595628258) so updated timeout to 20m for these tests.\r\n\r\n```\r\n-- Docs: https://docs.pytest.org/en/latest/warnings.html\r\n============================================================================================== 4 failed, 2058 passed, 17 skipped, 20 xfailed, 3 xpassed, 219 warnings in 256.51s (0:04:16) ===============================================================================================\r\n(scion)  ✘ pvicente@lenvopv-t490  ~/git/scion   master  pytest scion/tests --long\r\n```\r\n## Note:\r\n\r\nThere are integration tests failing see details (https://gitlab.com/wegift/scion/-/merge_requests/643) so this merge request is blocked by this fix.","head_pipeline_id":156374312,"id":61531412,"iid":642,"last_edited_at":"2020-06-15 14:47:52 UTC","last_edited_by_id":38913,"merge_commit_sha":null,"merge_error":null,"merge_params":{"force_remove_source_branch":"1"},"merge_status":"can_be_merged","merge_user_id":null,"merge_when_pipeline_succeeds":false,"milestone_id":null,"source_branch":"ch4023/gitlabci_changes_run_pytest_integration_tests","source_project_id":14982635,"state_id":1,"target_branch":"master","target_project_id":14982635,"time_estimate":0,"title":"Added pytest-integration to run pytests integration tests (--long) in master or schedule","updated_at":"2020-06-15 15:20:37 UTC","updated_by_id":38913,"url":"https://gitlab.com/wegift/scion/-/merge_requests/642","source":{"id":14982635,"name":"scion","description":":dancer: Get gifty :dancers: :beers:","web_url":"https://gitlab.com/wegift/scion","avatar_url":"https://gitlab.com/uploads/-/system/project/avatar/14982635/scion.png","git_ssh_url":"git@gitlab.com:wegift/scion.git","git_http_url":"https://gitlab.com/wegift/scion.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/scion","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/scion","url":"git@gitlab.com:wegift/scion.git","ssh_url":"git@gitlab.com:wegift/scion.git","http_url":"https://gitlab.com/wegift/scion.git"},"target":{"id":14982635,"name":"scion","description":":dancer: Get gifty :dancers: :beers:","web_url":"https://gitlab.com/wegift/scion","avatar_url":"https://gitlab.com/uploads/-/system/project/avatar/14982635/scion.png","git_ssh_url":"git@gitlab.com:wegift/scion.git","git_http_url":"https://gitlab.com/wegift/scion.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/scion","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/scion","url":"git@gitlab.com:wegift/scion.git","ssh_url":"git@gitlab.com:wegift/scion.git","http_url":"https://gitlab.com/wegift/scion.git"},"last_commit":{"id":"edfa4860fbe93352886edb12036d16cf8cd54dce","message":"Added pytest-integration to run pytests integration tests (--long) in\nmaster or schedule\n","title":"Added pytest-integration to run pytests integration tests (--long) in","timestamp":"2020-06-15T15:24:55+01:00","url":"https://gitlab.com/wegift/scion/-/commit/edfa4860fbe93352886edb12036d16cf8cd54dce","author":{"name":"Pedro Vicente","email":"pedro.vicente@wegift.io"}},"work_in_progress":false,"total_time_spent":0,"human_total_time_spent":null,"human_time_estimate":null,"assignee_ids":[38913,4273484,4788056,4788069],"state":"opened","action":"approval"},"labels":[],"changes":{"updated_at":{"previous":"2020-06-15 14:47:52 UTC","current":"2020-06-15 15:20:37 UTC"},"assignees":{"previous":[],"current":[{"name":"Pedro Vicente","username":"pedrovfer","avatar_url":"https://secure.gravatar.com/avatar/c773d8ace7d322db41030a6a80dbf1d3?s=80\u0026d=identicon","email":"pedro.vicente@wegift.io"},{"name":"Amadeusz Zolnowski","username":"az-wegift","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4273484/avatar.png","email":"amadeusz@wegift.io"},{"name":"Atta Rehman","username":"ar-wegift","avatar_url":"https://secure.gravatar.com/avatar/cdf5d423016002b15c16350181dd2613?s=80\u0026d=identicon","email":"atta@wegift.io"},{"name":"Will Pimblett","username":"will.pimblett","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4788069/avatar.png","email":"will@wegift.io"}]},"total_time_spent":{"previous":null,"current":0}},"repository":{"name":"scion","url":"git@gitlab.com:wegift/scion.git","description":":dancer: Get gifty :dancers: :beers:","homepage":"https://gitlab.com/wegift/scion"},"assignees":[{"name":"Pedro Vicente","username":"pedrovfer","avatar_url":"https://secure.gravatar.com/avatar/c773d8ace7d322db41030a6a80dbf1d3?s=80\u0026d=identicon","email":"pedro.vicente@wegift.io"},{"name":"Amadeusz Zolnowski","username":"az-wegift","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4273484/avatar.png","email":"amadeusz@wegift.io"},{"name":"Atta Rehman","username":"ar-wegift","avatar_url":"https://secure.gravatar.com/avatar/cdf5d423016002b15c16350181dd2613?s=80\u0026d=identicon","email":"atta@wegift.io"},{"name":"Will Pimblett","username":"will.pimblett","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/4788069/avatar.png","email":"will@wegift.io"}]}

### Prod approval

POST https://wegift-clubhub.herokuapp.com/gitlab-webhook
Content-Type: application/json

{"object_kind":"merge_request","event_type":"merge_request","user":{"name":"Clubhouse Bot","username":"will.pimblett","avatar_url":"https://assets.gitlab-static.net/uploads/-/system/user/avatar/5470008/avatar.png","email":"will+clubhouse@wegift.io"},"project":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"object_attributes":{"assignee_id":null,"author_id":4788069,"created_at":"2020-06-11 16:17:37 UTC","description":"","head_pipeline_id":null,"id":61285744,"iid":2,"last_edited_at":null,"last_edited_by_id":null,"merge_commit_sha":null,"merge_error":null,"merge_params":{"force_remove_source_branch":"1"},"merge_status":"can_be_merged","merge_user_id":null,"merge_when_pipeline_succeeds":false,"milestone_id":null,"source_branch":"ch3984/test2","source_project_id":19326693,"state_id":1,"target_branch":"master","target_project_id":19326693,"time_estimate":0,"title":"Update test.txt","updated_at":"2020-06-11 16:18:39 UTC","updated_by_id":null,"url":"https://gitlab.com/wegift/test-repo/-/merge_requests/2","source":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"target":{"id":19326693,"name":"Test Repo","description":"","web_url":"https://gitlab.com/wegift/test-repo","avatar_url":null,"git_ssh_url":"git@gitlab.com:wegift/test-repo.git","git_http_url":"https://gitlab.com/wegift/test-repo.git","namespace":"WeGift","visibility_level":0,"path_with_namespace":"wegift/test-repo","default_branch":"master","ci_config_path":"","homepage":"https://gitlab.com/wegift/test-repo","url":"git@gitlab.com:wegift/test-repo.git","ssh_url":"git@gitlab.com:wegift/test-repo.git","http_url":"https://gitlab.com/wegift/test-repo.git"},"last_commit":{"id":"23c082231d9e996655d415b592a643abd6e5ce84","message":"Update test.txt","title":"Update test.txt","timestamp":"2020-06-11T16:17:32+00:00","url":"https://gitlab.com/wegift/test-repo/-/commit/23c082231d9e996655d415b592a643abd6e5ce84","author":{"name":"Will Pimblett","email":"will@wegift.io"}},"work_in_progress":false,"total_time_spent":0,"human_total_time_spent":null,"human_time_estimate":null,"assignee_ids":[],"state":"opened","action":"approved"},"labels":[],"changes":{"updated_at":{"previous":"2020-06-11 16:17:37 UTC","current":"2020-06-11 16:18:39 UTC"},"total_time_spent":{"previous":null,"current":0}},"repository":{"name":"Test Repo","url":"git@gitlab.com:wegift/test-repo.git","description":"","homepage":"https://gitlab.com/wegift/test-repo"}}

